## Документация

### Общо описание

`creditera-bar` е [**Custom HTML Element**](https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_custom_elements) *(web component)*, който предоставя интерактивна лента за изчисляване на месечни вноски за кредит. Компонентът автоматично формулира месечната вноска въз основа на имотната цена, годишната лихва и периода на плащане, както и дава възможност за директно препращане към формуляр за кандидатстване през CREDITERA.

### Инсталиране

Свалете файла `creditera-bar.js` и го добавете в страницата си:
```html
<script src="./path/to/creditera-bar.js"></script>
```

### Усвояване

Конфигурирайте компонента чрез поддържаните аргументи и според съответния контекст, след което го поставете в страницата, където искате да се появи бара. Ето два примера:

#### Базов пример
```html
<creditera-bar 
  price="200000" 
  redirect-url="https://creditera.app.finbryte.com/form/3d182075-e6be-4d48-9ac6-3af5ab3f8a2c">
</creditera-bar>
```

#### Пълен пример с всички аргументи
```html
<creditera-bar 
  price="150000"
  redirect-url="https://creditera.app.finbryte.com/form/3d182075-e6be-4d48-9ac6-3af5ab3f8a2c"
  max-period="25"
  interest="2.5"
  loan-cap-percent="80"
  background-color="#F0F0F0"
  primary-color="#0066CC"
  alignment="center">
</creditera-bar>
```

### Аргументи

#### `price`
- **Описание**: Цена на имота, в евро (€)
- **Тип**: цяло число
- **Задължителен**: ДА
- **Стойност по подразбиране**: няма
- **Пример**: `price="200000"`

#### `redirect-url`
- **Описание**: URL адрес към формуляр за кандидатстване за кредит
- **Тип**: текст (URL)
- **Задължителен**: ДА
- **Стойност по подразбиране**: няма
- **Пример**: `redirect-url="https://creditera.app.finbryte.com/form/3d182075-e6be-4d48-9ac6-3af5ab3f8a2c"`

#### `max-period`
- **Описание**: Горна граница на периода на кредита в години
- **Тип**: цяло число
- **Задължителен**: НЕ
- **Стойност по подразбиране**: `30`
- **Ограничения**: минимум 4, максимум 30
- **Пример**: `years="25"`

#### `interest`
- **Описание**: Годишната лихвена ставка в проценти
- **Тип**: число
- **Задължителен**: НЕ
- **Стойност по подразбиране**: `2.19`
- **Пример**: `interest="2.5"`

#### `loan-cap-percent`
- **Описание**: Максимален процент от цената на имота, който може да бъде отпуснат като кредит
- **Тип**: число
- **Задължителен**: НЕ
- **Стойност по подразбиране**: `85`
- **Ограничения**: максимум 85
- **Пример**: `loan-cap-percent="80"`

#### `background-color`
- **Описание**: Цвят на фона на лентата
- **Тип**: HEX цвят
- **Задължителен**: НЕ
- **Стойност по подразбиране**: `#E6E6E6`
- **Пример**: `background-color="#F0F0F0"`

#### `primary-color`
- **Описание**: Акцентен цвят (за сумата на месечната вноска и бутона)
- **Тип**: HEX цвят
- **Задължителен**: НЕ
- **Стойност по подразбиране**: `#00AA33`
- **Пример**: `primary-color="#0066CC"`

#### `alignment`
- **Описание**: Подравняване на съдържанието в лентата
- **Тип**: текст
- **Задължителен**: НЕ
- **Стойност по подразбиране**: `left`
- **Възможни стойности**: `left`, `center`
- **Пример**: `alignment="center"`

### Функционалност

#### Автоматично изчисляване
Компонентът автоматично изчислява месечната вноска по формулата за анюитетно погасяване на базата на определен процент от подадената цена (по подразбиране 85% или стойност подадена чрез `loan-cap-percent` атрибута, съгласно нормативното ограничение на БНБ, че сумата по ипотечния кредит не може да надхвърля 85% от пазарната цена на имота):

```
M = P × [r × (1 + r)^n] / [(1 + r)^n - 1]
```

Където:
- M = месечна вноска
- P = сума на кредита *(loan-cap-percent от подадената цена)*
- r = месечна лихвена ставка *(interest / 12 / 100)*
- n = общ брой плащания *(years × 12)*

#### Интерактивност
- Бутон **ЗАЯВИ**, който води до предоставения чрез `redirect-url` линк към формуляр за кандидатстване (автоматично добавя `years` и `amount` query аргументи);
- Динамично обновяване на месечната вноска при промяна на годините.

#### Валидация
- Аргументът `price` е задължителен и трябва да бъде валидно число;
- Аргументът `redirect-url` е задължителен и трябва да бъде валиден URL адрес;
- Аргументът `max-period` се ограничава между 4 години и предвидената горна граница (по подразбиране 30 години);
- Аргументът `loan-cap-percent` се ограничава до максимум 85% (съгласно нормативните изисквания на БНБ);
- Аргументът `alignment` приема само стойности `left` или `center`.

### Технически изисквания

- Съвместимост с модерни браузъри, които поддържат Web Components;
- Не изисква допълнителни library/framework скриптове;
- Автоматично се регистрира като `creditera-bar` HTML element, няма нужда от извикване на глобална функция/метод.

### Поддръжка

За въпроси и проблеми, свързани с уеб компонента, моля пишете на [Мартин Методиев](mailto:martin@metodiev.bg).
